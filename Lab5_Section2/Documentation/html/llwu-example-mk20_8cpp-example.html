<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lab5_Section2: llwu-example-mk20.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lab5_Section2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('llwu-example-mk20_8cpp-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">llwu-example-mk20.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> ============================================================================</span></div><div class="line"><span class="comment"> * @file    llwu-example-mk20.cpp (180.ARM_Peripherals/Snippets/)</span></div><div class="line"><span class="comment"> * @brief   Demonstrates various Run and Low-power modes and LLWU</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *  Created on: 25/09/2017</span></div><div class="line"><span class="comment"> *      Author: podonoghue</span></div><div class="line"><span class="comment"> ============================================================================</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * This examples assumes that appropriate clock configurations have been created:</span></div><div class="line"><span class="comment"> *  - RUN_CLOCK_CONFIG   = ClockConfig_PEE_48MHz   For RUN mode (Core=48MHz, Bus=24MHz, Flash=27MHz)</span></div><div class="line"><span class="comment"> *  - VLPR_CLOCK_CONFIG  = ClockConfig_BLPE_4MHz   For VLPR (Core/Bus = 4MHz, Flash = 1MHz)</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Interrupts must be configured for GPIO pin used, LLWU, LPTMR</span></div><div class="line"><span class="comment"> * It will also be necessary to modify the linker memory map so that only</span></div><div class="line"><span class="comment"> * lowest portion of SRAM_U (0x10000000..) is used if testing of LLS2 is intended.</span></div><div class="line"><span class="comment"> * Interrupts will need to be enabled for Pin (GPIO), LPTMR and LLWU.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Note: The STOP mode doesn&#39;t seem to work from RUN mode while using the</span></div><div class="line"><span class="comment"> * debugger.  INVSTATE occurs occasionally. Stand-alone it&#39;s OK.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * MK20D5 Power transition notes</span></div><div class="line"><span class="comment"> * LLS -&gt; RUN mode on wake-up irrespective of whether it is entered from RUN or VLPR</span></div><div class="line"><span class="comment"> * VLPS -&gt; RUN mode on wake-up if entered from RUN or LPWUI is set</span></div><div class="line"><span class="comment"> * VLPS -&gt; VLPR only if entered from VLPR and LPWUI is not set</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="hardware_8h.html">hardware.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="mcg_8h.html">mcg.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="smc_8h.html">smc.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="lptmr_8h.html">lptmr.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="llwu_8h.html">llwu.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="pmc_8h.html">pmc.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rcm_8h.html">rcm.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// Allow access to USBDM methods without USBDM:: prefix</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespace_u_s_b_d_m.html">USBDM</a>;</div><div class="line"></div><div class="line"><span class="comment">// Define clock modes to use</span></div><div class="line"><span class="keyword">static</span> <a class="code" href="group___m_c_g___group.html#ga7a3f88aee696150f11131655b5060278">ClockConfig</a> RUN_CLOCK_CONFIG    = <a name="a0"></a><a class="code" href="group___m_c_g___group.html#gga7a3f88aee696150f11131655b5060278aef92c955472ac5ead729f4b9d4df4e12">ClockConfig_PEE_48MHz</a>;</div><div class="line"><span class="keyword">static</span> <a class="code" href="group___m_c_g___group.html#ga7a3f88aee696150f11131655b5060278">ClockConfig</a> VLPR_CLOCK_CONFIG   = <a name="a1"></a><a class="code" href="group___m_c_g___group.html#gga7a3f88aee696150f11131655b5060278a6ff12f95c136ff8d6cca0466aa43022d">ClockConfig_BLPE_4MHz</a>;</div><div class="line"></div><div class="line"><span class="comment">// May need reduced baud rate for slow clocks</span></div><div class="line"><span class="keyword">static</span> constexpr <span class="keywordtype">int</span> BAUD_RATE = 115200;</div><div class="line"></div><div class="line"><span class="comment">// Using LEDs rather defeats VLLSx mode!</span></div><div class="line"><span class="keyword">using</span> RedLed    = <a name="_a2"></a><a class="code" href="class_u_s_b_d_m_1_1_gpio_c.html">GpioC&lt;3,ActiveLow&gt;</a>;</div><div class="line"><span class="keyword">using</span> GreenLed  = <a name="_a3"></a><a class="code" href="class_u_s_b_d_m_1_1_gpio_d.html">GpioD&lt;4,ActiveLow&gt;</a>;</div><div class="line"><span class="keyword">using</span> BlueLed   = <a name="_a4"></a><a class="code" href="class_u_s_b_d_m_1_1_gpio_a.html">GpioA&lt;2,ActiveLow&gt;</a>;</div><div class="line"></div><div class="line"><span class="comment">// Timer to use for timed wake-up</span></div><div class="line"><span class="keyword">using</span> WakeupTimer = <a name="a5"></a><a class="code" href="group___l_p_t_m_r___group.html#ga5b2010298755b536f85b729ff0328a82">Lptmr0</a>;</div><div class="line"></div><div class="line"><span class="comment">// LLWU Pin Filter to use</span></div><div class="line"><span class="keyword">static</span> constexpr <a class="code" href="group___l_l_w_u___group.html#gacc97593f72d9dd0e0054db82daa57a9e">LlwuFilterNum</a> FILTER_NUM = <a name="a6"></a><a class="code" href="group___l_l_w_u___group.html#ggacc97593f72d9dd0e0054db82daa57a9eafc7ae71e3538cc9b31dca2bb3d3e960f">LlwuFilterNum_0</a>;</div><div class="line"></div><div class="line"><span class="comment">// LLWU Pin to use for wake-up</span></div><div class="line"><span class="keyword">using</span> WakeupPin = Llwu::Pin&lt;LlwuPin_Ptc1&gt;;</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/** Possible tests - must be in this order */</span></div><div class="line"><span class="keyword">enum</span> Test {</div><div class="line">   NONE, STOP, VLPS, WAIT, VLPW, LLS, VLLS0, VLLS1, VLLS2, VLLS3,</div><div class="line">};</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/** Names of tests - must match enum Test{} */</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *TestNames[] = {</div><div class="line">   <span class="stringliteral">&quot;NONE &quot;</span>, <span class="stringliteral">&quot;STOP &quot;</span>, <span class="stringliteral">&quot;VLPS &quot;</span>, <span class="stringliteral">&quot;WAIT &quot;</span>, <span class="stringliteral">&quot;VLPW &quot;</span>, <span class="stringliteral">&quot;LLS  &quot;</span>, <span class="stringliteral">&quot;VLLS0&quot;</span>, <span class="stringliteral">&quot;VLLS1&quot;</span>, <span class="stringliteral">&quot;VLLS2&quot;</span>, <span class="stringliteral">&quot;VLLS3&quot;</span>,</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">struct </span>PreservedData {</div><div class="line">   Test     test;                <span class="comment">///&lt; Test being run</span></div><div class="line"><span class="comment"></span>   <span class="keywordtype">unsigned</span> testCount;           <span class="comment">///&lt; Current repeated test count</span></div><div class="line"><span class="comment"></span>   uint8_t  timerDelay;          <span class="comment">///&lt; Delay for timer (seconds)</span></div><div class="line"><span class="comment"></span>   <span class="keywordtype">bool</span>     continuousTest;      <span class="comment">///&lt; Whether to run test continuously</span></div><div class="line"><span class="comment"></span>   <span class="keywordtype">bool</span>     enablePin;           <span class="comment">///&lt; Whether to enable Pin interrupt/wake-up</span></div><div class="line"><span class="comment"></span>   <span class="keywordtype">bool</span>     <a name="a7"></a><a class="code" href="namespace_u_s_b_d_m.html#a6ed8566be1f27191f82ce6d0c805fcc4">enableTimer</a>;         <span class="comment">///&lt; Whether to enable Timer interrupt/wake-up</span></div><div class="line"><span class="comment"></span>   <span class="keywordtype">bool</span>     pinHandlerRan;       <span class="comment">///&lt; Flag to indicate Pin handler ran</span></div><div class="line"><span class="comment"></span>   <span class="keywordtype">bool</span>     timerHandlerRan;     <span class="comment">///&lt; Flag to indicate Timer handler ran</span></div><div class="line"><span class="comment"></span>   <span class="keywordtype">bool</span>     llwuHandlerRan;      <span class="comment">///&lt; Flag to indicate LLWU handler ran</span></div><div class="line"><span class="comment"></span>};</div><div class="line"></div><div class="line">static_assert(<span class="keyword">sizeof</span>(PreservedData) &lt; <span class="keyword">sizeof</span>(<a name="_a8"></a><a class="code" href="struct_r_f_s_y_s___type.html">RFSYS_Type</a>));</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * The following are located in the Register file which is maintained in</span></div><div class="line"><span class="comment"> * Low-leakage modes and preserved across reset.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> PreservedData preservedData = (*(PreservedData*)(<a name="a9"></a><a class="code" href="group___r_f_s_y_s___peripheral__access__layer___g_r_o_u_p.html#ga2dab66eae1abcaf22879dbce661ea2fa">RFSYS_BASE_PTR</a>));</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Call-back for Timer</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> wakeupTimerCallback() {</div><div class="line">   <span class="comment">// We could also put code here that would execute on LPTMR event</span></div><div class="line">   preservedData.timerHandlerRan = <span class="keyword">true</span>;</div><div class="line">   WakeupTimer::clearInterruptFlag();</div><div class="line">   WakeupTimer::enableInterrupts(<span class="keyword">false</span>);</div><div class="line">   __asm__(<span class="stringliteral">&quot;nop&quot;</span>);</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Call-back for direct pin interrupt</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param[in] status 32-bit value from ISFR (each bit indicates a pin interrupt source)</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> pinCallback(uint32_t status __attribute__((unused))) {</div><div class="line">   <a name="a10"></a><a class="code" href="error_8h.html#ad85546c3822965abd94bc5e72243f313">usbdm_assert</a>(status &amp; (WakeupPin::PORT_BITMASK), <span class="stringliteral">&quot;Unexpected pin interrupt&quot;</span>);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (status &amp; (WakeupPin::PORT_BITMASK)) {</div><div class="line">      preservedData.pinHandlerRan = <span class="keyword">true</span>;</div><div class="line">   }</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Call-back for LLWU events</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> llwuCallback() {</div><div class="line">   preservedData.llwuHandlerRan = <span class="keyword">true</span>;</div><div class="line">   <span class="keywordflow">if</span> (<a name="a11"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a4ecc53fde910f901b8ca80d58ee9341d">Llwu::isPeripheralWakeupSource</a>(<a name="a12"></a><a class="code" href="group___l_l_w_u___group.html#gga2549788891ec2ed44c6b5d518722c9a8a6237e38f54ca2bae52d2dd74213ca709">LlwuPeripheral_Lptmr</a>)) {</div><div class="line">      <span class="comment">// Wake-up from LPTMR</span></div><div class="line">      WakeupTimer::clearInterruptFlag();</div><div class="line">      WakeupTimer::enableInterrupts(<span class="keyword">false</span>);</div><div class="line">   }</div><div class="line">   <span class="keywordflow">if</span> (<a name="a13"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a7d69c3279c42c1ac4c6a5cf698a9a6d5">Llwu::isPinWakeupSource</a>(WakeupPin::pin)) {</div><div class="line">      <span class="comment">// Wake-up from pin</span></div><div class="line">      <a name="a14"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a6717c2b838be1191774a17592d38fff9">Llwu::clearPinWakeupFlag</a>(WakeupPin::pin);</div><div class="line">   }</div><div class="line">   <span class="keywordflow">if</span> (<a name="a15"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a2e84e1b2749e032b5870ba77b9efdc33">Llwu::isFilteredPinWakeupSource</a>(FILTER_NUM)) {</div><div class="line">      <span class="comment">// Wake-up from filtered pin</span></div><div class="line">      <a name="a16"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a0a8abe64d1b4978262894d0986dad204">Llwu::clearFilteredPinWakeupFlag</a>(FILTER_NUM);</div><div class="line">   }</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> *  Test Stop Modes</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param smcStopMode            STOP mode to enter - STOP,VLPS,LLS,VLLS</span></div><div class="line"><span class="comment"> * @param smcLowLeakageStopMode  VLLS mode to enter VLLS0,1,2,3 (for VLLS only)</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> testStopMode(</div><div class="line">      <a class="code" href="group___s_m_c___group.html#gae98572aa728af3ae8d7b73ea8809a944">SmcStopMode</a>             smcStopMode,</div><div class="line">      <a class="code" href="group___s_m_c___group.html#ga31a9c3ee4669c3706c0f9de4124ba133">SmcLowLeakageStopMode</a>   smcLowLeakageStopMode=<a name="a17"></a><a class="code" href="group___s_m_c___group.html#gga31a9c3ee4669c3706c0f9de4124ba133a0ca336a1e6a69d4cf8519fd0607e862d">SmcLowLeakageStopMode_VLLS3</a>) {</div><div class="line"></div><div class="line">   <span class="keywordflow">switch</span> (smcStopMode) {</div><div class="line">      <span class="keywordflow">case</span> <a name="a18"></a><a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944a369e20ff4de8eaaa896d3a7a79a8362d">SmcStopMode_NormalStop</a>:           <a name="a19"></a><a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a name="a20"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Doing Normal Stop\n&quot;</span>);           <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> <a name="a21"></a><a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944abce3a9a9b5fcdaecb274256e6c86223c">SmcStopMode_VeryLowPowerStop</a>:     <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Doing Very Low Power Stop\n&quot;</span>);   <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> <a name="a22"></a><a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ad352d5433a9de08efa490eb45e67703b">SmcStopMode_LowLeakageStop</a>:       <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Doing Low Leakage Stop\n&quot;</span>);      <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> <a name="a23"></a><a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ac8a1757cd3f1110aac6861c65222fe67">SmcStopMode_VeryLowLeakageStop</a>:   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Doing Very Low Leakage Stop\n&quot;</span>); <span class="keywordflow">break</span>;</div><div class="line">   };</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> ((smcStopMode!=<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ad352d5433a9de08efa490eb45e67703b">SmcStopMode_LowLeakageStop</a>)&amp;&amp;(smcStopMode!=<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ac8a1757cd3f1110aac6861c65222fe67">SmcStopMode_VeryLowLeakageStop</a>)) {</div><div class="line">      <span class="comment">// Not using LLWU</span></div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a name="a24"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Disabling LLWU&quot;</span>).<a name="a25"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">      <a name="a26"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#afff0633731030e14a1b6ea1e1ae9f7ba">Llwu::disableAllSources</a>();</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Set STOP mode to enter</span></div><div class="line">   <a name="a27"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a327e180b0bc1818b7fc68ba9fd958295">Smc::setStopMode</a>(smcStopMode);</div><div class="line">   <a name="a28"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a904811707c75ec2904788554961c5e28">Smc::setStopOptions</a>(smcLowLeakageStopMode);</div><div class="line"></div><div class="line">   <span class="comment">/*</span></div><div class="line"><span class="comment">    * Go to sleep - LPTMR or PIN wake-up</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Deep Sleeping...&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line"></div><div class="line">   <a name="a29"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a649f4d5725d8773731f5f0ed484b2cba">Smc::enterStopMode</a>();</div><div class="line"></div><div class="line">   <a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#afff0633731030e14a1b6ea1e1ae9f7ba">Llwu::disableAllSources</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Make sure handlers have run</span></div><div class="line">   <a name="a30"></a><a class="code" href="namespace_u_s_b_d_m.html#ad4b50dfe4106221f5205e2b2137cb492">waitMS</a>(10);</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef MCG_C6_PLLS_MASK</span></div><div class="line">   <span class="comment">/*</span></div><div class="line"><span class="comment">    * If back in RUN mode we need to restore clock as</span></div><div class="line"><span class="comment">    * MCG transitions PEE-&gt;PBE when in STOP modes.</span></div><div class="line"><span class="comment">    * This assumes run mode is PEE</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <span class="keywordflow">if</span> (<a name="a31"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a3a0f473afc13ef6e185d0a6cf0bb7651">Smc::getStatus</a>() == <a name="a32"></a><a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fba6d8658393b06d15a63fc6de40d7cd92d">SmcStatus_RUN</a>) {</div><div class="line">      <a name="a33"></a><a class="code" href="class_u_s_b_d_m_1_1_mcg.html#acffdf9269905c6a8bed06122c8d31bf5">Mcg::clockTransition</a>(<a name="a34"></a><a class="code" href="class_u_s_b_d_m_1_1_mcg.html#a67b4998a3e418e74650ac8a3f417bb0d">Mcg::clockInfo</a>[RUN_CLOCK_CONFIG]);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a name="a35"></a><a class="code" href="class_u_s_b_d_m_1_1_uart__brfa___t.html#a91e27d012dbf3855adc031d7758b5190">setBaudRate</a>(BAUD_RATE);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;**** Awake ****&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Restored clock frequency&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">   }</div><div class="line">   <span class="keywordflow">else</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">   {</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;**** Awake ****&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">   }</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Test Wait modes</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param smcRunMode Mode to test</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> testWaitMode(<a class="code" href="group___s_m_c___group.html#ga8f7d25c07186f16274f2bfdb53e12979">SmcRunMode</a> smcRunMode) {</div><div class="line">   <span class="comment">/*</span></div><div class="line"><span class="comment">    * Go to sleep - LPTMR or PIN wake-up</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <span class="keywordflow">switch</span> (smcRunMode) {</div><div class="line">      <span class="keywordflow">case</span> <a name="a36"></a><a class="code" href="group___s_m_c___group.html#gga8f7d25c07186f16274f2bfdb53e12979aeb20fb3bcf7aa42bdfacd5a41274bbe2">SmcRunMode_Normal</a>:           <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Doing Wait\n&quot;</span>);                  <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> <a name="a37"></a><a class="code" href="group___s_m_c___group.html#gga8f7d25c07186f16274f2bfdb53e12979a7998b987c42ac18b97b80ac3f04e2856">SmcRunMode_VeryLowPower</a>:     <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Doing Very Low Power Wait\n&quot;</span>);   <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line">   };</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Sleeping...&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">   <a name="a38"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a24dd5ecbd3c8a6d0b30076ee6a423f96">Smc::enterWaitMode</a>();</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Awake!&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Enable pin wake-up</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param[in] preservedData Setting for test</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> enablePin(<span class="keyword">const</span> PreservedData preservedData) {</div><div class="line"></div><div class="line">   <span class="comment">// Disable filtered pin</span></div><div class="line">   <a name="a39"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a38d589b93c46da2e1d90dc4e11efd732">Llwu::configureFilteredPinSource</a>(</div><div class="line">         FILTER_NUM,</div><div class="line">         WakeupPin::pin,</div><div class="line">         <a name="a40"></a><a class="code" href="group___l_l_w_u___group.html#ggab479eac292bced3eaa970876838e8cd0a1f88221abd08a5834b6255cf3fa70ff7">LlwuFilterPinMode_Disabled</a>);</div><div class="line"></div><div class="line">   <span class="comment">// Disable direct pin</span></div><div class="line">   <a name="a41"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a078fb56ba6b4d5a2d7c7e99f3d1d13fd">Llwu::configurePinSource</a>(</div><div class="line">         WakeupPin::pin,</div><div class="line">         <a name="a42"></a><a class="code" href="group___l_l_w_u___group.html#ggaf6578958d890a3e7752121ee70880276a2f83d1c6953be5bdfda24ebe308f25ee">LlwuPinMode_Disabled</a>);</div><div class="line"></div><div class="line">   <span class="comment">// Disable wake-up pin</span></div><div class="line">   WakeupPin::setInput(</div><div class="line">         <a name="a43"></a><a class="code" href="group___peripheral_pin_tables.html#ggad54854b5479931edb9f84488f3967abea82fbf0ab842c821bc0a2df5e24ae2055">PinPull_Up</a>,</div><div class="line">         <a name="a44"></a><a class="code" href="group___peripheral_pin_tables.html#ggae992525946c5196946be11ee4c139139a65e4fd0c8d45553504b6ba26ff4e3925">PinAction_None</a>,</div><div class="line">         <a name="a45"></a><a class="code" href="group___peripheral_pin_tables.html#ggacfe130faec928dbda2bf5f390058e04aa07f191321bdc0867c89795edfb55ce11">PinFilter_Passive</a>);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (preservedData.enablePin &amp;&amp; (preservedData.test&gt;=LLS)) {</div><div class="line"></div><div class="line">      <span class="comment">// Use LLWU in most Low-leakage modes</span></div><div class="line">      <a name="a46"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a1d1e592388349808d735076e0e72bdb7">Llwu::clearAllFlags</a>();</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (preservedData.test!=VLLS0) {</div><div class="line">         <span class="comment">// LLWU from filtered pin</span></div><div class="line">         <span class="comment">// Not available in VLLS0 as LPO not running</span></div><div class="line">         <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Configuring filtered LLWU pin wake-up&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">         <a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a38d589b93c46da2e1d90dc4e11efd732">Llwu::configureFilteredPinSource</a>(</div><div class="line">               FILTER_NUM,</div><div class="line">               WakeupPin::pin,</div><div class="line">               <a name="a47"></a><a class="code" href="group___l_l_w_u___group.html#ggab479eac292bced3eaa970876838e8cd0a40b729debfde5f9110c5aa058da3332a">LlwuFilterPinMode_FallingEdge</a>);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">else</span> {</div><div class="line">         <span class="comment">// LLWU direct from pin</span></div><div class="line">         <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Configuring direct LLWU pin wake-up&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">         <a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a078fb56ba6b4d5a2d7c7e99f3d1d13fd">Llwu::configurePinSource</a>(</div><div class="line">               WakeupPin::pin,</div><div class="line">               <a name="a48"></a><a class="code" href="group___l_l_w_u___group.html#ggaf6578958d890a3e7752121ee70880276ab4d333c095aee1af10b7df9cfe22891c">LlwuPinMode_FallingEdge</a>);</div><div class="line">      }</div><div class="line">      <a name="a49"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a1c7dfec33b9dc945a439a900fb3007ca">Llwu::setCallback</a>(llwuCallback);</div><div class="line">      <a name="a50"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a184f39083207a87fa4f30be43ea97ae6">Llwu::enableNvicInterrupts</a>(<a name="a51"></a><a class="code" href="hardware_8h.html#a7c8f445c1595473f9c473c29c30f47c8a484f3c1e0f4b27d3327f8d8f2f820009">NvicPriority_Normal</a>);</div><div class="line">   }</div><div class="line">   <span class="keywordflow">if</span> (preservedData.enablePin &amp;&amp; (preservedData.test&lt;LLS)) {</div><div class="line"></div><div class="line">      <span class="comment">// Enable pin interrupt if not low-leakage mode</span></div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Configuring pin interrupt for wake-up&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line"></div><div class="line">      <span class="comment">// Configure wake-up via GPIO interrupt</span></div><div class="line">      WakeupPin::setInput(</div><div class="line">            <a class="code" href="group___peripheral_pin_tables.html#ggad54854b5479931edb9f84488f3967abea82fbf0ab842c821bc0a2df5e24ae2055">PinPull_Up</a>,</div><div class="line">            <a name="a52"></a><a class="code" href="group___peripheral_pin_tables.html#ggae992525946c5196946be11ee4c139139af56f80c37f7a05be9441d352a81bd629">PinAction_IrqFalling</a>,</div><div class="line">            <a class="code" href="group___peripheral_pin_tables.html#ggacfe130faec928dbda2bf5f390058e04aa07f191321bdc0867c89795edfb55ce11">PinFilter_Passive</a>);</div><div class="line"></div><div class="line">      WakeupPin::clearInterruptFlag();</div><div class="line">      WakeupPin::setCallback(pinCallback);</div><div class="line">      WakeupPin::enablePinNvicInterrupts(<a class="code" href="hardware_8h.html#a7c8f445c1595473f9c473c29c30f47c8a484f3c1e0f4b27d3327f8d8f2f820009">NvicPriority_Normal</a>);</div><div class="line">   }</div><div class="line">   <span class="keywordflow">else</span> {</div><div class="line">      WakeupPin::disablePinNvicInterrupts();</div><div class="line">   }</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Enable LPTMR wake-up</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param[in] preservedData Setting for test</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespace_u_s_b_d_m.html#a6ed8566be1f27191f82ce6d0c805fcc4">enableTimer</a>(<span class="keyword">const</span> PreservedData preservedData) {</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (preservedData.enableTimer) {</div><div class="line">      <span class="comment">// Set up wake-up timer</span></div><div class="line">      <span class="comment">// Note - need a clock source that operates in LLSx e.g. ERCLK32</span></div><div class="line"></div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Configuring timer interrupt&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line"></div><div class="line">      WakeupTimer::configureTimeCountingMode(</div><div class="line">            <a name="a53"></a><a class="code" href="group___l_p_t_m_r___group.html#gga6e1dacc28d6d100a97e569c5e53a9c1ba71c07edb3e0cbc567a1ea6f07a462956">LptmrResetOn_Compare</a>,</div><div class="line">            <a name="a54"></a><a class="code" href="group___l_p_t_m_r___group.html#gga6a50a2ca8c5656855ed73c6af731ea70a93cfe24342f7fcc41ee037f10ce4f8ac">LptmrInterrupt_Enabled</a>,</div><div class="line">            <a name="a55"></a><a class="code" href="group___l_p_t_m_r___group.html#ggaef728b324304a6551eacad08a682cf76ac20436edd9bb97c5f0397ca0d6e01af3">LptmrClockSel_Lpoclk</a>);</div><div class="line">      WakeupTimer::setPeriod(preservedData.timerDelay*<a name="a56"></a><a class="code" href="namespace_u_s_b_d_m.html#ad1bd923aa17a83c966221e32ecf2ed19">seconds</a>);</div><div class="line">      WakeupTimer::setCallback(wakeupTimerCallback);</div><div class="line">      WakeupTimer::enableNvicInterrupts(<a class="code" href="hardware_8h.html#a7c8f445c1595473f9c473c29c30f47c8a484f3c1e0f4b27d3327f8d8f2f820009">NvicPriority_Normal</a>);</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (preservedData.test&gt;=LLS) {</div><div class="line"></div><div class="line">         <span class="comment">// Use LLWU with timer</span></div><div class="line">         <a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a1d1e592388349808d735076e0e72bdb7">Llwu::clearAllFlags</a>();</div><div class="line"></div><div class="line">         <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Configuring timer LLWU wake-up&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">         <a name="a57"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a2fcf868f15568c5fb80d082e24e3ed06">Llwu::configurePeripheralSource</a>(<a class="code" href="group___l_l_w_u___group.html#gga2549788891ec2ed44c6b5d518722c9a8a6237e38f54ca2bae52d2dd74213ca709">LlwuPeripheral_Lptmr</a>);</div><div class="line">      }</div><div class="line">   }</div><div class="line">   <span class="keywordflow">else</span> {</div><div class="line">      WakeupTimer::disableNvicInterrupts();</div><div class="line">   }</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Report which handlers ran</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> reportHandlersRun() {</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Timer callback() &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(preservedData.timerHandlerRan?<span class="stringliteral">&quot;Ran&quot;</span>:<span class="stringliteral">&quot;Didn&#39;t run&quot;</span>);</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Pin callback()   &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(preservedData.pinHandlerRan?<span class="stringliteral">&quot;Ran&quot;</span>:<span class="stringliteral">&quot;Didn&#39;t run&quot;</span>);</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;LLWU callback()  &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(preservedData.llwuHandlerRan?<span class="stringliteral">&quot;Ran&quot;</span>:<span class="stringliteral">&quot;Didn&#39;t run&quot;</span>);</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;**************************************&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Run single test</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param[in, out] preservedData Setting for test</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> runSingleTest(PreservedData &amp;preservedData) {</div><div class="line"></div><div class="line">   <span class="comment">// Timer can&#39;t be used with VLLS0</span></div><div class="line">   preservedData.enableTimer =  preservedData.enableTimer &amp;&amp; (preservedData.test!=VLLS0);</div><div class="line"></div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;\n**************************************&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Running Test: &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(TestNames[preservedData.test]).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;, #&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(preservedData.testCount);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (preservedData.test == NONE) {</div><div class="line">      <span class="comment">// Not a test</span></div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (!preservedData.enablePin &amp;&amp; !preservedData.enableTimer) {</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Can&#39;t do test without Pin or Timer wake-up method\n&quot;</span>);</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Clear call-back flags</span></div><div class="line">   preservedData.pinHandlerRan   = <span class="keyword">false</span>;</div><div class="line">   preservedData.llwuHandlerRan  = <span class="keyword">false</span>;</div><div class="line">   preservedData.timerHandlerRan = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">   <a class="code" href="namespace_u_s_b_d_m.html#a6ed8566be1f27191f82ce6d0c805fcc4">enableTimer</a>(preservedData);</div><div class="line">   enablePin(preservedData);</div><div class="line"></div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Wake-up using &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(preservedData.enablePin?<span class="stringliteral">&quot;Pin, &quot;</span>:<span class="stringliteral">&quot;&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(preservedData.enableTimer?<span class="stringliteral">&quot;Timer&quot;</span>:<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"></div><div class="line">   <span class="keywordflow">switch</span>(preservedData.test) {</div><div class="line">      <span class="keywordflow">case</span> WAIT:  testWaitMode(<a class="code" href="group___s_m_c___group.html#gga8f7d25c07186f16274f2bfdb53e12979aeb20fb3bcf7aa42bdfacd5a41274bbe2">SmcRunMode_Normal</a>);             <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> VLPW:  testWaitMode(<a class="code" href="group___s_m_c___group.html#gga8f7d25c07186f16274f2bfdb53e12979a7998b987c42ac18b97b80ac3f04e2856">SmcRunMode_VeryLowPower</a>);       <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> STOP:  testStopMode(<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944a369e20ff4de8eaaa896d3a7a79a8362d">SmcStopMode_NormalStop</a>);        <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> VLPS:  testStopMode(<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944abce3a9a9b5fcdaecb274256e6c86223c">SmcStopMode_VeryLowPowerStop</a>);  <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> LLS:   testStopMode(<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ad352d5433a9de08efa490eb45e67703b">SmcStopMode_LowLeakageStop</a>);    <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> VLLS0: testStopMode(<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ac8a1757cd3f1110aac6861c65222fe67">SmcStopMode_VeryLowLeakageStop</a>, <a name="a58"></a><a class="code" href="group___s_m_c___group.html#gga31a9c3ee4669c3706c0f9de4124ba133a8ed8cd7af73db0ac118dba608ddf8dcb">SmcLowLeakageStopMode_VLLS0</a>); <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> VLLS1: testStopMode(<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ac8a1757cd3f1110aac6861c65222fe67">SmcStopMode_VeryLowLeakageStop</a>, <a name="a59"></a><a class="code" href="group___s_m_c___group.html#gga31a9c3ee4669c3706c0f9de4124ba133ab78bb17ecd3f7769b40b90cab356b467">SmcLowLeakageStopMode_VLLS1</a>); <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> VLLS2: testStopMode(<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ac8a1757cd3f1110aac6861c65222fe67">SmcStopMode_VeryLowLeakageStop</a>, <a name="a60"></a><a class="code" href="group___s_m_c___group.html#gga31a9c3ee4669c3706c0f9de4124ba133a43dd50e8feb162f0371a3ff5528b5577">SmcLowLeakageStopMode_VLLS2</a>); <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> VLLS3: testStopMode(<a class="code" href="group___s_m_c___group.html#ggae98572aa728af3ae8d7b73ea8809a944ac8a1757cd3f1110aac6861c65222fe67">SmcStopMode_VeryLowLeakageStop</a>, <a class="code" href="group___s_m_c___group.html#gga31a9c3ee4669c3706c0f9de4124ba133a0ca336a1e6a69d4cf8519fd0607e862d">SmcLowLeakageStopMode_VLLS3</a>); <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> NONE: <span class="keywordflow">break</span>;</div><div class="line">   }</div><div class="line">   <a name="a61"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a194a001491535226bcdb942897e509ed">Llwu::disableNvicInterrupts</a>();</div><div class="line">   WakeupTimer::disableNvicInterrupts();</div><div class="line">   WakeupPin::disablePinNvicInterrupts();</div><div class="line"></div><div class="line">   reportHandlersRun();</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Run repeated test</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param[in] preservedData Setting for test</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> runRepeatedTest(PreservedData &amp;preservedData) {</div><div class="line">   <span class="keywordflow">do</span> {</div><div class="line">      preservedData.testCount++;</div><div class="line">      runSingleTest(preservedData);</div><div class="line">   } <span class="keywordflow">while</span> (preservedData.continuousTest &amp; (<a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a name="a62"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#abca3ff46c849f1cd5e4db7650663a79e">peek</a>() &lt; 0));</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (preservedData.continuousTest) {</div><div class="line">      <span class="comment">// Discard break char</span></div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a name="a63"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a1d40791b6bcf6ebe69a91946874c6dfc">readChar</a>();</div><div class="line">   }</div><div class="line">}</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Change run mode</span></div><div class="line"><span class="comment"> * VLPR&lt;-&gt;RUN</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @return Run mode entered</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <a class="code" href="group___s_m_c___group.html#ga3ad1095ea418d174a12df332f95365fb">SmcStatus</a> changeRunMode() {</div><div class="line">   <a class="code" href="group___s_m_c___group.html#ga3ad1095ea418d174a12df332f95365fb">SmcStatus</a> smcStatus = <a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a3a0f473afc13ef6e185d0a6cf0bb7651">Smc::getStatus</a>();</div><div class="line">   <span class="keywordflow">if</span> (smcStatus == <a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fba6d8658393b06d15a63fc6de40d7cd92d">SmcStatus_RUN</a>) {</div><div class="line">      <span class="comment">// RUN-&gt;VLPR</span></div><div class="line">      <a class="code" href="class_u_s_b_d_m_1_1_mcg.html#acffdf9269905c6a8bed06122c8d31bf5">Mcg::clockTransition</a>(<a class="code" href="class_u_s_b_d_m_1_1_mcg.html#a67b4998a3e418e74650ac8a3f417bb0d">Mcg::clockInfo</a>[VLPR_CLOCK_CONFIG]);</div><div class="line">      <a name="a64"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#aaac7fbc92025d0a6286038c941aa1cff">Smc::enterRunMode</a>(<a class="code" href="group___s_m_c___group.html#gga8f7d25c07186f16274f2bfdb53e12979a7998b987c42ac18b97b80ac3f04e2856">SmcRunMode_VeryLowPower</a>);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_uart__brfa___t.html#a91e27d012dbf3855adc031d7758b5190">setBaudRate</a>(BAUD_RATE);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Changed to VLPR mode&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">   }</div><div class="line">   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (smcStatus == <a name="a65"></a><a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fbad65b5f0bb9f9c5aed17b9366ae2d31f2">SmcStatus_VLPR</a>) {</div><div class="line">      <span class="comment">// VLPR-&gt;RUN mode</span></div><div class="line">      <a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#aaac7fbc92025d0a6286038c941aa1cff">Smc::enterRunMode</a>(<a class="code" href="group___s_m_c___group.html#gga8f7d25c07186f16274f2bfdb53e12979aeb20fb3bcf7aa42bdfacd5a41274bbe2">SmcRunMode_Normal</a>);</div><div class="line">      <a class="code" href="class_u_s_b_d_m_1_1_mcg.html#acffdf9269905c6a8bed06122c8d31bf5">Mcg::clockTransition</a>(<a class="code" href="class_u_s_b_d_m_1_1_mcg.html#a67b4998a3e418e74650ac8a3f417bb0d">Mcg::clockInfo</a>[RUN_CLOCK_CONFIG]);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_uart__brfa___t.html#a91e27d012dbf3855adc031d7758b5190">setBaudRate</a>(BAUD_RATE);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Changed to RUN mode&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">   }</div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a3a0f473afc13ef6e185d0a6cf0bb7651">Smc::getStatus</a>();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> help() {</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(</div><div class="line">         <span class="stringliteral">&quot;\n\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;********************************************************************************\n&quot;</span></div><div class="line">#ifdef <a name="a66"></a><a class="code" href="group___s_m_c___register___masks___g_r_o_u_p.html#ga13fe417a536c3dc080bb978a13a6364d">SMC_PMCTRL_LPWUI_MASK</a></div><div class="line">         <span class="stringliteral">&quot;LPWUI - Whether to exit VLPR, VLPW and VLPS to RUN mode on interrupt\n&quot;</span></div><div class="line">#endif</div><div class="line">         <span class="stringliteral">&quot;RUN   - Full speed run mode\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;VLPR  - Very Low Power Run mode (reduced speed)\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;WAIT  - Wait mode (enter from RUN only)\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;VLPW  - Very low power wait (enter from VLPR only)\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;STOP  - Stop mode (enter from RUN only)\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;VLPS  - Very low power Stop\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;LLS2  - Low Leakage Stop 2 - Partial SRAMU retained\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;LLS3  - Low Leakage Stop 3 - All RAM retained\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;VLLS0 - Very Low Leakage Stop 0 - No SRAM, exit via LLWU reset\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;VLLS1 - Very Low Leakage Stop 1 - No SRAM, exit via LLWU reset\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;VLLS2 - Very Low Leakage Stop 2 - Partial SRAMU retained, exit via LLWU reset\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;VLLS3 - Very Low Leakage Stop 3 - All RAM retained, exit via LLWU reset\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;LPTMR - Low Power Timer (Uses LPO so not available in VLLS0)\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;Pin   - Port Pin used for interrupt or wake-up source\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;Cont  - Run tests continuously until a key is pressed\n&quot;</span></div><div class="line">         <span class="stringliteral">&quot;********************************************************************************\n&quot;</span></div><div class="line">   );</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a name="a67"></a><a class="code" href="mma845x-example_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {</div><div class="line">   <span class="comment">// Set UART (console) clock to clock source available in VLPR mode</span></div><div class="line">   <span class="comment">//SimInfo::setUart0Clock(SimUartClockSource_OscerClk);</span></div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_uart__brfa___t.html#a91e27d012dbf3855adc031d7758b5190">setBaudRate</a>(BAUD_RATE);</div><div class="line"></div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;\n**************************************&quot;</span>);</div><div class="line">   <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;Executing from RESET, SRS=&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<a name="a68"></a><a class="code" href="class_u_s_b_d_m_1_1_rcm_base___t.html#a6012b44935932fe15211f14539e0fb27">Rcm::getResetSourceDescription</a>());</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> ((<a name="a69"></a><a class="code" href="class_u_s_b_d_m_1_1_rcm_base___t.html#a70431eaae2dfac9a5f513a6c27a76855">Rcm::getResetSource</a>() &amp; <a name="a70"></a><a class="code" href="group___r_c_m___group.html#ggaf4dbd0f5bdd9c2e185f677d81642dbf5a04c3582f5119557826a7088227f6f433">RcmSource_Wakeup</a>) != 0) {</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;========================================&quot;</span>);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;Reset due to LLWU&quot;</span>);</div><div class="line"></div><div class="line">      <span class="keywordtype">bool</span> llwuDeviceFlag  = <a name="a71"></a><a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a7fc26ffedc26d5477c281a287d0e7f82">Llwu::getPeripheralWakeupSources</a>()&amp;<a class="code" href="group___l_l_w_u___group.html#gga2549788891ec2ed44c6b5d518722c9a8a6237e38f54ca2bae52d2dd74213ca709">LlwuPeripheral_Lptmr</a>;</div><div class="line">      <span class="keywordtype">bool</span> llwuPinFlags    = <a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a7d69c3279c42c1ac4c6a5cf698a9a6d5">Llwu::isPinWakeupSource</a>(WakeupPin::pin);</div><div class="line">      <span class="keywordtype">bool</span> llwuFilterFlag  = <a class="code" href="class_u_s_b_d_m_1_1_llwu_base___t.html#a2e84e1b2749e032b5870ba77b9efdc33">Llwu::isFilteredPinWakeupSource</a>(FILTER_NUM);</div><div class="line"></div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;LLWU DeviceFlag = &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(llwuDeviceFlag);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;LLWU PinFlag    = &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(llwuPinFlags);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;LLWU FilterFlag = &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(llwuFilterFlag);</div><div class="line">      reportHandlersRun();</div><div class="line">   }</div><div class="line">   <span class="keywordflow">else</span> {</div><div class="line">      <span class="comment">// Only allows repeated tests from reset if LLWU</span></div><div class="line">      preservedData.continuousTest = <span class="keyword">false</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Configure LEDs as off to reduce power</span></div><div class="line">   RedLed::setOutput(   <a name="a72"></a><a class="code" href="group___peripheral_pin_tables.html#gga41b0e776b3badb014a0fa2c3261d4c57a2f1142550360f67b113d19b07c3526c7">PinDriveStrength_High</a>, <a name="a73"></a><a class="code" href="group___peripheral_pin_tables.html#gga30bcd8163a6d2d4cb90f3577ecf5131da85f1bfd2aacae14cf2b1dbc40040de5e">PinDriveMode_PushPull</a>, <a name="a74"></a><a class="code" href="group___peripheral_pin_tables.html#gga78a40136f7aee020e528dffbdf0e7e39a4d67f0011827f3934c975846d3c22fdd">PinSlewRate_Slow</a>);</div><div class="line">   GreenLed::setOutput( <a class="code" href="group___peripheral_pin_tables.html#gga41b0e776b3badb014a0fa2c3261d4c57a2f1142550360f67b113d19b07c3526c7">PinDriveStrength_High</a>, <a class="code" href="group___peripheral_pin_tables.html#gga30bcd8163a6d2d4cb90f3577ecf5131da85f1bfd2aacae14cf2b1dbc40040de5e">PinDriveMode_PushPull</a>, <a class="code" href="group___peripheral_pin_tables.html#gga78a40136f7aee020e528dffbdf0e7e39a4d67f0011827f3934c975846d3c22fdd">PinSlewRate_Slow</a>);</div><div class="line">   BlueLed::setOutput(  <a class="code" href="group___peripheral_pin_tables.html#gga41b0e776b3badb014a0fa2c3261d4c57a2f1142550360f67b113d19b07c3526c7">PinDriveStrength_High</a>, <a class="code" href="group___peripheral_pin_tables.html#gga30bcd8163a6d2d4cb90f3577ecf5131da85f1bfd2aacae14cf2b1dbc40040de5e">PinDriveMode_PushPull</a>, <a class="code" href="group___peripheral_pin_tables.html#gga78a40136f7aee020e528dffbdf0e7e39a4d67f0011827f3934c975846d3c22fdd">PinSlewRate_Slow</a>);</div><div class="line"></div><div class="line">   <span class="comment">// Enable all power modes</span></div><div class="line">   <a name="a75"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a3045fd7755d24a8d4a80f2d3a1276c8a">Smc::enablePowerModes</a>(</div><div class="line">         <a name="a76"></a><a class="code" href="group___s_m_c___group.html#ggaba25d67336820a5d04723a6cbe06939fa461f7cc5151b5d4ff7e4899ce3f7a8c8">SmcVeryLowPower_Enabled</a>,</div><div class="line">         <a name="a77"></a><a class="code" href="group___s_m_c___group.html#gga8d9f07974996e41350162690c9ad9271a82ea4049786733e2d39d1c6573c7b11f">SmcLowLeakageStop_Enabled</a>,</div><div class="line">         <a name="a78"></a><a class="code" href="group___s_m_c___group.html#gga38e5f4cf64d5141f065bfdbeff7f9c67af5147895b5e75bf92b97858b742daa42">SmcVeryLowLeakageStop_Enabled</a>);</div><div class="line"></div><div class="line">   <span class="comment">//Errata e4481 STOP mode recovery unstable</span></div><div class="line">   <a name="a79"></a><a class="code" href="class_u_s_b_d_m_1_1_pmc_base___t.html#a6af6a6499bf89a24e3128683e9b66b18">Pmc::setBandgapOperation</a>(<a name="a80"></a><a class="code" href="group___p_m_c___group.html#ggacaf7b9443710e55abaf0a224ca038811a77a51966f09187ac4eccaa73c464b854">PmcBandgapBuffer_Off</a>, <a name="a81"></a><a class="code" href="group___p_m_c___group.html#gga6e3e636e12540bc93cdc725fbf443036a748ae79e2228bf9bc03d92482d922d82">PmcBandgapLowPowerEnable_On</a>);</div><div class="line"></div><div class="line">   <a name="a82"></a><a class="code" href="namespace_u_s_b_d_m.html#ab59696ecaf96d6ee79249ea003869d7a">checkError</a>();</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (preservedData.continuousTest) {</div><div class="line">      <span class="comment">// Must be running repeated VLLS test</span></div><div class="line">      runRepeatedTest(preservedData);</div><div class="line">   }</div><div class="line"></div><div class="line">   preservedData.test           = STOP;</div><div class="line">   preservedData.continuousTest = <span class="keyword">false</span>;</div><div class="line">   preservedData.enablePin      = <span class="keyword">true</span>;</div><div class="line">   preservedData.enableTimer    = <span class="keyword">true</span>;</div><div class="line">   preservedData.timerDelay     = 5;</div><div class="line"></div><div class="line">   <span class="keywordtype">bool</span>  refresh                 = <span class="keyword">true</span>;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef SMC_PMCTRL_LPWUI_MASK</span></div><div class="line">   <span class="keywordtype">bool</span> lpwui = <span class="keyword">false</span>;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">   <span class="keywordflow">for</span>(;;) {</div><div class="line">      <a class="code" href="group___s_m_c___group.html#ga3ad1095ea418d174a12df332f95365fb">SmcStatus</a> smcStatus = <a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a3a0f473afc13ef6e185d0a6cf0bb7651">Smc::getStatus</a>();</div><div class="line">      <span class="keywordflow">if</span> (refresh) {</div><div class="line">         <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;SystemCoreClock  = &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(::<a name="a83"></a><a class="code" href="system_8h.html#aa3cd3e43291e81e795d642b79b6088e6">SystemCoreClock</a>/1000000.0).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot; MHz&quot;</span>);</div><div class="line">         <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;SystemBusClock   = &quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(::<a name="a84"></a><a class="code" href="system_8h.html#a1cae06db4e857f7822c1b820d71809ab">SystemBusClock</a>/1000000.0).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot; MHz&quot;</span>);</div><div class="line"></div><div class="line">         <span class="keywordflow">switch</span>(smcStatus) {</div><div class="line">            <span class="keywordflow">default</span>:</div><div class="line">            <span class="keywordflow">case</span> <a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fba6d8658393b06d15a63fc6de40d7cd92d">SmcStatus_RUN</a>:</div><div class="line">               <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(</div><div class="line">                     <span class="stringliteral">&quot;\nTests\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;====================================\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;R   - Change run mode - VLPR, RUN\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;S   - Select STOP, VLPS test\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;W   - Select WAIT test\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;L   - Select LLS test\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;V   - Select VLLS0, VLLS1, VLLS2, VLLS3 test\n&quot;</span></div><div class="line">#ifdef <a class="code" href="group___s_m_c___register___masks___g_r_o_u_p.html#ga13fe417a536c3dc080bb978a13a6364d">SMC_PMCTRL_LPWUI_MASK</a></div><div class="line">                     <span class="stringliteral">&quot;I   - Toggle LPWUI (Exit VLP to Run mode on interrupt)\n&quot;</span></div><div class="line">#endif</div><div class="line">                     <span class="stringliteral">&quot;T   - Toggle LPTMR wake-up (not available in VLLS0)\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;P   - Toggle PIN wake-up source\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;C   - Toggle Continuous tests\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;+/- - Change timer delay\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;H - Help\n&quot;</span></div><div class="line">               );</div><div class="line">               <span class="keywordflow">break</span>;</div><div class="line">            <span class="keywordflow">case</span> <a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fbad65b5f0bb9f9c5aed17b9366ae2d31f2">SmcStatus_VLPR</a>:</div><div class="line">               <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(</div><div class="line">                     <span class="stringliteral">&quot;\nTests\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;====================================\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;R   - Change run mode - VLPR, RUN\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;S   - Select VLPS test\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;W   - Select VLPW test\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;L   - Select LLS test\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;V   - Select VLLS0, VLLS1, VLLS2, VLLS3 test\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;T   - Toggle LPTMR wake-up (not available in VLLS0)\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;P   - Toggle PIN wake-up\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;C   - Toggle Continuous tests\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;+/- - Change timer delay\n&quot;</span></div><div class="line">                     <span class="stringliteral">&quot;H   - Help\n&quot;</span></div><div class="line">               );</div><div class="line">               <span class="keywordflow">break</span>;</div><div class="line">         }</div><div class="line">         refresh = <span class="keyword">false</span>;</div><div class="line">      }</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;\rE - Run Test (&quot;</span>);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<a name="a85"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a119f74471c7ba5394304f10b245d00c6">Smc::getSmcStatusName</a>());</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;:&quot;</span>);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<a name="a86"></a><a class="code" href="class_u_s_b_d_m_1_1_mcg.html#a80b5ba2ad8891bcbc80e63b36e33be22">Mcg::getClockModeName</a>());</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;@&quot;</span>);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(::<a class="code" href="system_8h.html#aa3cd3e43291e81e795d642b79b6088e6">SystemCoreClock</a>);</div><div class="line"><span class="preprocessor">#ifdef SMC_PMCTRL_LPWUI_MASK</span></div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(lpwui?<span class="stringliteral">&quot;, LPWUI&quot;</span>:<span class="stringliteral">&quot;       &quot;</span>);</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(preservedData.continuousTest?<span class="stringliteral">&quot;, Cont&quot;</span>:<span class="stringliteral">&quot;      &quot;</span>);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(preservedData.enablePin?<span class="stringliteral">&quot;, Pin&quot;</span>:<span class="stringliteral">&quot;     &quot;</span>);</div><div class="line">      <span class="keywordflow">if</span> (preservedData.enableTimer&amp;&amp;(preservedData.test!=VLLS0)) {</div><div class="line">         <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;, Timer(&quot;</span>).<a name="a87"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad92512602a8b16b6faf4c2e1f62043cd">setWidth</a>(2).<a name="a88"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ab258d96105e89cee73817521f6b9085d">setPadding</a>(<a name="a89"></a><a class="code" href="group___f_o_r_m_a_t_t_e_d___i_o___group.html#ggafdf6b051ad933dd9783c0c02a37256f6a003d6380e401ad7a267c14b31ebc921c">Padding_LeadingSpaces</a>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(preservedData.timerDelay).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;)&quot;</span>);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">else</span> {</div><div class="line">         <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;           &quot;</span>);</div><div class="line">      }</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a name="a90"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a8e254572bb045dd67ac090479f86ef47">resetFormat</a>();</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;, Test=&quot;</span>);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(TestNames[preservedData.test]);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a4379e10167a471cccd90826d239c7a7e">write</a>(<span class="stringliteral">&quot;) :   &quot;</span>);</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a name="a91"></a><a class="code" href="class_u_s_b_d_m_1_1_uart.html#a2952f382ccb864a0ce3b3e6951caf2ba">flushOutput</a>();</div><div class="line">      <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a name="a92"></a><a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a6e99487f7884a18f65579de6ea2ec834">setEcho</a>(<a name="a93"></a><a class="code" href="group___f_o_r_m_a_t_t_e_d___i_o___group.html#gga9f6f8400c3200e34451d17a508829d8cafbe695732fd95607f269d8952fefaeca">EchoMode_Off</a>);</div><div class="line">      <span class="keywordtype">int</span> command = toupper(<a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a1d40791b6bcf6ebe69a91946874c6dfc">readChar</a>());</div><div class="line">      <span class="keywordflow">switch</span>(command) {</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:</div><div class="line">            <span class="keywordflow">if</span> (smcStatus==<a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fba6d8658393b06d15a63fc6de40d7cd92d">SmcStatus_RUN</a>) {</div><div class="line">               preservedData.test = (preservedData.test==VLPS)?STOP:VLPS;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (smcStatus==<a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fbad65b5f0bb9f9c5aed17b9366ae2d31f2">SmcStatus_VLPR</a>) {</div><div class="line">               preservedData.test = VLPS;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;W&#39;</span>:</div><div class="line">            <span class="keywordflow">if</span> (smcStatus==<a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fba6d8658393b06d15a63fc6de40d7cd92d">SmcStatus_RUN</a>) {</div><div class="line">               preservedData.test = WAIT;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (smcStatus==<a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fbad65b5f0bb9f9c5aed17b9366ae2d31f2">SmcStatus_VLPR</a>) {</div><div class="line">               preservedData.test = VLPW;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:</div><div class="line">               preservedData.test = LLS;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>:</div><div class="line">            preservedData.test =</div><div class="line">                 ((preservedData.test != VLLS0)&amp;&amp;</div><div class="line">                  (preservedData.test != VLLS1)&amp;&amp;</div><div class="line">                  (preservedData.test != VLLS2))?VLLS0:(Test)(preservedData.test+1);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:</div><div class="line">            <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>(<span class="stringliteral">&quot;\n&quot;</span>).<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">            <span class="keywordflow">switch</span>(changeRunMode()) {</div><div class="line">               <span class="keywordflow">default</span>:</div><div class="line">                  <span class="keywordflow">break</span>;</div><div class="line">               <span class="keywordflow">case</span> <a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fbad65b5f0bb9f9c5aed17b9366ae2d31f2">SmcStatus_VLPR</a>:</div><div class="line">                  <span class="keywordflow">if</span> (preservedData.test==WAIT) {</div><div class="line">                     preservedData.test=VLPW;</div><div class="line">                  }</div><div class="line">                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (preservedData.test==STOP) {</div><div class="line">                     preservedData.test=VLPS;</div><div class="line">                  }</div><div class="line">               <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">            refresh = <span class="keyword">true</span>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"><span class="preprocessor">#ifdef SMC_PMCTRL_LPWUI_MASK</span></div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:</div><div class="line">            <span class="keywordflow">if</span> (smcStatus==<a class="code" href="group___s_m_c___group.html#gga3ad1095ea418d174a12df332f95365fba6d8658393b06d15a63fc6de40d7cd92d">SmcStatus_RUN</a>) {</div><div class="line">               lpwui = !lpwui;</div><div class="line">               <a name="a94"></a><a class="code" href="class_u_s_b_d_m_1_1_smc_base___t.html#a86fda6c609960ce716fe584ce56a2a96">Smc::setExitVeryLowPowerOnInterrupt</a>(lpwui?<a name="a95"></a><a class="code" href="group___s_m_c___group.html#ggaa79327b7edac516e211a453af8e43101aed4c5ab565eed09bd3eda48685a54f4e">SmcExitVeryLowPowerOnInt_Enabled</a>:<a name="a96"></a><a class="code" href="group___s_m_c___group.html#ggaa79327b7edac516e211a453af8e43101a5dda2c3058857dce5cbfd86a0b63b6e8">SmcExitVeryLowPowerOnInt_Disabled</a>);</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>:</div><div class="line">            preservedData.enablePin = !preservedData.enablePin;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:</div><div class="line">            preservedData.enableTimer = !preservedData.enableTimer;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>:</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;?&#39;</span>:</div><div class="line">            help();</div><div class="line">            refresh = <span class="keyword">true</span>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div><div class="line">            preservedData.continuousTest = !preservedData.continuousTest;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;+&#39;</span>:</div><div class="line">            <span class="keywordflow">if</span> (preservedData.timerDelay&lt;99) {</div><div class="line">               preservedData.timerDelay++;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;-&#39;</span>:</div><div class="line">            <span class="keywordflow">if</span> (preservedData.timerDelay&gt;1) {</div><div class="line">               preservedData.timerDelay--;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <span class="charliteral">&#39;E&#39;</span>:</div><div class="line">            <span class="keywordflow">if</span> (preservedData.test != NONE) {</div><div class="line">               <a class="code" href="group___c_o_n_s_o_l_e___group.html#ga7ab1ae5607fc5d9c172baec4df3d39e2">console</a>.<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#a42b3d46b9d0a086e5c0ea157c9c2aaaa">writeln</a>().<a class="code" href="class_u_s_b_d_m_1_1_formatted_i_o.html#ad198391c6d91ca8e666df31ee11b2aa1">flushOutput</a>();</div><div class="line">               preservedData.testCount = 0;</div><div class="line">               runRepeatedTest(preservedData);</div><div class="line">               refresh = <span class="keyword">true</span>;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line">      }</div><div class="line">   }</div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Oct 31 2019 16:45:42 for Lab5_Section2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
